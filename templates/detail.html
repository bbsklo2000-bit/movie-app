<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ movie.title }} - Movie Hub</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        body { font-family: 'Kanit', sans-serif; }
        /* ตกแต่ง Scrollbar ของช่องรีวิว */
        .custom-scrollbar::-webkit-scrollbar { width: 5px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: #1a1a1a; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #444; border-radius: 10px; }
    </style>
</head>
<body class="bg-[#2b2b2b] text-white min-h-screen">
    
    <header class="bg-[#8b2b2b] p-4 shadow-lg sticky top-0 z-50">
        <div class="max-w-6xl mx-auto flex items-center">
            <a href="/" class="text-white hover:text-gray-300 transition flex items-center gap-2">
                <i class="fa-solid fa-arrow-left"></i> กลับหน้าหลัก
            </a>
        </div>
    </header>

    <main class="max-w-6xl mx-auto p-6 mt-6">
        <div class="flex flex-col md:flex-row gap-10 bg-[#333] p-8 rounded-2xl shadow-2xl border border-zinc-700">
            <div class="w-full md:w-80 shrink-0">
                <img src="{{ movie.img }}" class="rounded-lg shadow-2xl w-full border-2 border-zinc-600">
            </div>
            
            <div class="flex-1">
                <h1 class="text-5xl font-bold mb-3 text-white">{{ movie.title }}</h1>
                <div class="flex flex-wrap gap-3 text-gray-400 text-sm mb-6">
                    <span class="bg-zinc-800 px-3 py-1 rounded-md">{{ movie.year }}</span>
                    <span class="bg-zinc-800 px-3 py-1 rounded-md">{{ movie.type }}</span>
                    <span class="bg-zinc-800 px-3 py-1 rounded-md">{{ movie.category }}</span>
                </div>
                
                <h3 class="text-xl font-semibold mb-3 border-l-4 border-red-600 pl-3">เรื่องย่อ :</h3>
                <p class="text-gray-300 leading-relaxed text-lg mb-10">
                    {{ movie.description }}
                </p>
                
                <a href="#review-box" class="bg-white text-black px-10 py-3 rounded-full font-bold hover:bg-gray-200 transition shadow-lg inline-flex items-center gap-2">
                    <i class="fa-solid fa-comments"></i> รีวิวจากสมาชิก
                </a>
            </div>
        </div>

        <div class="my-16 flex justify-center">
            <div class="w-24 h-1 bg-red-600 rounded-full"></div>
        </div>

        <div id="review-box" class="max-w-3xl mx-auto bg-[#1a1a1a] p-8 rounded-2xl border border-zinc-800 shadow-2xl mb-20">
            <h2 class="text-2xl font-bold text-white mb-6 flex items-center gap-3">
                <i class="fa-solid fa-users text-red-500"></i> รีวิวจากสมาชิก
            </h2>

            <div class="h-[450px] overflow-y-auto mb-6 space-y-4 pr-4 custom-scrollbar flex flex-col">
                {% for review in reviews %}
                <div class="bg-[#242424] p-4 rounded-tr-2xl rounded-br-2xl rounded-bl-2xl self-start max-w-[90%] border-l-4 border-red-600 shadow-sm">
                    <div class="flex justify-between items-center gap-10 mb-2">
                        <span class="text-sm font-bold text-yellow-500">{{ review.username }}</span>
                        <span class="text-[10px] text-gray-500">{{ review.timestamp }}</span>
                    </div>
                    <p class="text-[15px] text-gray-200 leading-snug">{{ review.content }}</p>
                </div>
                {% else %}
                <div class="flex flex-col items-center justify-center h-full text-gray-500">
                    <i class="fa-solid fa-comment-slash text-4xl mb-2"></i>
                    <p>ยังไม่มีรีวิวสำหรับเรื่องนี้...</p>
                </div>
                {% endfor %}
            </div>

            {% if session.get('username') %}
            <form action="/add_review/{{ movie.id }}" method="POST" class="flex gap-3 mt-4">
                <input type="text" name="comment" placeholder="เขียนรีวิวของคุณที่นี่..." required
                       class="flex-1 bg-zinc-900 text-white border border-zinc-700 rounded-full px-6 py-3 text-sm outline-none focus:border-red-600 focus:ring-1 focus:ring-red-600 transition">
                <button class="bg-red-700 hover:bg-red-800 text-white px-8 py-3 rounded-full text-sm font-bold transition shadow-lg">
                    ส่งรีวิว
                </button>
            </form>
            {% else %}
            <div class="text-center p-4 bg-zinc-900/50 rounded-xl border border-dashed border-zinc-700">
                <p class="text-gray-400 text-sm">ต้องการรีวิว? <a href="/login" class="text-red-500 font-bold hover:underline">เข้าสู่ระบบที่นี่</a></p>
            </div>
            {% endif %}
        </div>
    </main>

</body>
</html>